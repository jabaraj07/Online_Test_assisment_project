{"ast":null,"code":"import axios from \"axios\";\nimport { appendEvent, getPendingEvents, removeEventsById, toBackendPayload } from \"./eventLogPersistence\";\nconst API_BASE = \"http://localhost:5000\";\nexport const logEvent = async ({\n  attemptId,\n  eventType,\n  questionId = null,\n  metadata = {}\n}) => {\n  const timestamp = new Date().toISOString();\n  const id = typeof crypto !== \"undefined\" && crypto.randomUUID ? crypto.randomUUID() : `evt_${Date.now()}_${Math.random().toString(36).slice(2)}`;\n  const event = {\n    id,\n    eventType,\n    timestamp,\n    questionId,\n    metadata\n  };\n  appendEvent(attemptId, event);\n  try {\n    const response = await axios.post(`${API_BASE}/api/attempt/${attemptId}/event`, {\n      events: [{\n        eventType,\n        timestamp,\n        questionId,\n        metadata\n      }]\n    });\n    removeEventsById(attemptId, [id]);\n    return response.data;\n  } catch (error) {\n    var _error$response;\n    console.error(\"Error logging event:\", ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n  }\n};\n\n/**\r\n * Flush events persisted locally (e.g. after offline or page refresh).\r\n * Call this when the test page loads so pending events are sent to the backend.\r\n */\nexport const flushPendingEvents = async attemptId => {\n  const pending = getPendingEvents(attemptId);\n  if (pending.length === 0) return;\n  const {\n    events,\n    ids\n  } = toBackendPayload(pending);\n  try {\n    await axios.post(`${API_BASE}/api/attempt/${attemptId}/event`, {\n      events\n    });\n    removeEventsById(attemptId, ids);\n  } catch (error) {\n    var _error$response2;\n    console.error(\"Flush pending events failed:\", ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || error.message);\n  }\n};\nexport const submitTest = async attemptId => {\n  try {\n    const response = await axios.post(`${API_BASE}/api/attempt/submit/${attemptId}`);\n    return response.data;\n  } catch (error) {\n    var _error$response3;\n    console.error(\"Submit failed:\", ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) || error.message);\n    throw error;\n  }\n};\nexport const getAttemptById = async attemptId => {\n  const response = await axios.get(`${API_BASE}/api/attempt/${attemptId}`);\n  return response.data;\n};","map":{"version":3,"names":["axios","appendEvent","getPendingEvents","removeEventsById","toBackendPayload","API_BASE","logEvent","attemptId","eventType","questionId","metadata","timestamp","Date","toISOString","id","crypto","randomUUID","now","Math","random","toString","slice","event","response","post","events","data","error","_error$response","console","message","flushPendingEvents","pending","length","ids","_error$response2","submitTest","_error$response3","getAttemptById","get"],"sources":["C:/Project/Online_Test_Project/Front-End/online_test/src/services/api.js"],"sourcesContent":["import axios from \"axios\";\r\nimport {\r\n  appendEvent,\r\n  getPendingEvents,\r\n  removeEventsById,\r\n  toBackendPayload,\r\n} from \"./eventLogPersistence\";\r\n\r\nconst API_BASE = \"http://localhost:5000\";\r\n\r\nexport const logEvent = async ({\r\n  attemptId,\r\n  eventType,\r\n  questionId = null,\r\n  metadata = {},\r\n}) => {\r\n  const timestamp = new Date().toISOString();\r\n  const id = typeof crypto !== \"undefined\" && crypto.randomUUID\r\n    ? crypto.randomUUID()\r\n    : `evt_${Date.now()}_${Math.random().toString(36).slice(2)}`;\r\n  const event = {\r\n    id,\r\n    eventType,\r\n    timestamp,\r\n    questionId,\r\n    metadata,\r\n  };\r\n\r\n  appendEvent(attemptId, event);\r\n\r\n  try {\r\n    const response = await axios.post(\r\n      `${API_BASE}/api/attempt/${attemptId}/event`,\r\n      { events: [{ eventType, timestamp, questionId, metadata }] },\r\n    );\r\n    removeEventsById(attemptId, [id]);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\r\n      \"Error logging event:\",\r\n      error.response?.data || error.message,\r\n    );\r\n  }\r\n};\r\n\r\n/**\r\n * Flush events persisted locally (e.g. after offline or page refresh).\r\n * Call this when the test page loads so pending events are sent to the backend.\r\n */\r\nexport const flushPendingEvents = async (attemptId) => {\r\n  const pending = getPendingEvents(attemptId);\r\n  if (pending.length === 0) return;\r\n\r\n  const { events, ids } = toBackendPayload(pending);\r\n  try {\r\n    await axios.post(\r\n      `${API_BASE}/api/attempt/${attemptId}/event`,\r\n      { events },\r\n    );\r\n    removeEventsById(attemptId, ids);\r\n  } catch (error) {\r\n    console.error(\r\n      \"Flush pending events failed:\",\r\n      error.response?.data || error.message,\r\n    );\r\n  }\r\n};\r\n\r\nexport const submitTest = async (attemptId) => {\r\n  try {\r\n    const response = await axios.post(\r\n      `${API_BASE}/api/attempt/submit/${attemptId}`,\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Submit failed:\", error.response?.data || error.message);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getAttemptById = async (attemptId) => {\r\n  const response = await axios.get(\r\n    `${API_BASE}/api/attempt/${attemptId}`,\r\n  );\r\n  return response.data;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}